{% extends "accounts/base.html" %}
{% block content %}

<h2>My Audio Files</h2>

<div class="card p-4">

    <!-- Upload new audio -->
    <form method="POST" enctype="multipart/form-data" action="{% url 'accounts:audio' %}">
        {% csrf_token %}
        <label class="fw-bold">Upload New Audio:</label>
        <input type="file" class="form-control mb-2" name="audio" accept="audio/*" required>
        <button class="btn btn-primary w-100" type="submit" name="action" value="upload">
            Upload New Audio
        </button>
    </form>

    <hr>

    <h4>Your Uploaded Audios</h4>

    {% if audios %}
        {% for audio in audios %}
            <div class="border p-3 mb-3 rounded">

                <p><strong>File:</strong> {{ audio.file.name }}</p>
                <audio controls style="width:100%;">
                    <source src="{{ audio.file.url }}">
                </audio>

                <!-- Replace -->
                <form method="POST" enctype="multipart/form-data" action="{% url 'accounts:audio' %}" class="mt-3">
                    {% csrf_token %}
                    <input type="hidden" name="audio_id" value="{{ audio.id }}">
                    <input type="file" class="form-control mb-2" name="audio" accept="audio/*" required>
                    <button class="btn btn-warning w-100" type="submit" name="action" value="replace">
                        Replace This Audio
                    </button>
                </form>

                <!-- Delete -->
                <a href="{% url 'accounts:delete_audio' audio.id %}" 
                   class="btn btn-danger w-100 mt-2"
                   onclick="return confirm('Delete this audio?');">
                    Delete Audio
                </a>

            </div>
        {% endfor %}
    {% else %}
        <p>No audio uploaded yet.</p>
    {% endif %}

</div>

{% endblock %}
